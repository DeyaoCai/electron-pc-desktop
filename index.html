<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="./style/index.css">
  <link rel="stylesheet" href="./style/frame.css">
</head>
<body >
<div class="wrap">
  <audio id="audio" autoplay preload="auto"></audio>
  <div class="reload">刷新</div>
</div>
  <script>
    const path = require("path");
    require(path.join(__dirname, "../proxy/appExpress.js"));
    // require(path.join(__dirname, "../proxy/appSocket.js"));


    setTimeout(()=>{
      // 初始化一个 WebSocket 对象
      // var ws = new WebSocket("ws://127.0.0.1:3332");

      // 建立 web socket 连接成功触发事件
      // ws.onopen = function () {
      //   // 使用 send() 方法发送数据
      //   ws.send("发送数据");
      //   console.log("数据发送中...");
      // };
      //
      // // 接收服务端数据时触发事件
      // ws.onmessage = function (evt) {
      //   var received_msg = evt.data;
      //   console.log("数据已接收...");
      // };
      //
      // // 断开 web socket 连接成功触发事件
      // ws.onclose = function (e) {
      //   console.log(e)
      //   console.log("连接已关闭...");
      // };
      // fetch(`http://localhost:9898/dev-tool/testGet`, {method: 'PSOT', headers: {
      //     "Content-Type": "application/json"
      //   },body: JSON.stringify({
      //     firstParam: 'yourValue',
      //     secondParam: 'secondValue',
      //   })}).then(res=> console.log(res.json()))

      fetch(`http://localhost:9898/dev-tool/ctoolsConf`, {method: 'GET', headers: {
          "Content-Type": "application/json"
        }}).then(res=> console.log(res.json()))
    },1000);
    window.shortCut = require(path.join(__dirname, "./src/tools/shortCut.js"))();
    shortCut.init();
    shortCut.alt(123,function(){
      ipcRenderer.send('openDevTools');
    });

    window.baseTools = require(path.join(__dirname, "./baseTools.js"));

    const fs= require("fs");
    const electron = require('electron');
    const {ipcRenderer} = electron;
    const {createRender,timeout} = require(path.join(__dirname, "./src/tools/CreateRender.js"));

    const tempB = createRender(require(path.join(__dirname, "./src/units/desktopDot.js")));
    const tempImg = createRender(require(path.join(__dirname, "./src/units/desktopImg.js")));
    let prevImg = null;
    let imges;
    let currentImgSrc;
    try {
      imges = fs.readdirSync(path.join(__dirname, "./img"));
      currentImgSrc = imges[0];
      if (currentImgSrc) {
        timeout(function () {
          imges.push(imges.shift())
          currentImgSrc = imges[0];
          tempImg(document.querySelector("body"));
        },3000)();

        timeout(function () {
          tempB(document.querySelector("body"))
        },150)();
      }
    } catch (e) {
      alert("请执行 npm run ht 来爬取背景图片！");
    }


    // const tempPop = createRender(require(path.join(__dirname, "./src/units/popup.js")));
    // const tempCTip= createRender(require(path.join(__dirname, "./src/units/cTip.js")));
    // timeout(function () {
    //   const time = new Date().getHours();
    //   if (time >=  22) {
    //     tempPop(document.querySelector(".wrap"), {slot: tempCTip,data: {content: "警告", title: "您需要休息了！"}, delay: 1000});
    //   }
    // },5000)();
    // createRender(require(path.join(__dirname, "./src/units/search.js")))(document.querySelector("body"));

    document.querySelector(".reload").onclick=function(){
      window.location.reload();
    }

    // require(path.join(__dirname, "./src/router/router.js"));

    // const dataSearchMusic = require(path.join(__dirname, "./src/units/searchMusic.js"));
    // const tempSearchMusic = createRender(dataSearchMusic);
    // tempSearchMusic(document.querySelector("body"));

    // const dataCmd = require(path.join(__dirname, "./src/units/cmd.js"));
    // const tempCmd = createRender(dataCmd);
    // tempCmd(document.querySelector("body"));

  </script>
  <style>
  </style>
</body>
</html>
